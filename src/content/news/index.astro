---
// src/pages/news/index.astro
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { Image } from 'astro:assets';
import SiteBanner from '../../assets/SiteBanner.png';
import { getCollection } from 'astro:content';

const posts = await getCollection('news');
const sortedPosts = posts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const SITE_TITLE = 'News - Football Techs';
const SITE_DESCRIPTION =
  'Latest NFL and College Football news, analysis, and AI-powered betting picks from Football Techs';
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>

  <body>
    <!-- Hero Banner with Nav Overlay -->
    <div class="hero-banner">
      <Image
        src={SiteBanner}
        alt="Football Techs News"
        width={1920}
        height={600}
        format="webp"
        loading="eager"
      />
      <div class="nav-overlay">
        <Header />
      </div>

      <div class="hero-overlay">
        <div class="hero-inner">
          <h1>News &amp; Analysis</h1>
          <p>Latest NFL + CFB insights, AI picks, and betting edges from Football Techs.</p>

          <div class="hero-actions">
            <a class="btn ghost" href="https://x.com/FootballTechs" target="_blank" rel="noopener">
              Follow on X
            </a>
          </div>
        </div>
      </div>
    </div>

    <main class="page-content">
      <section class="news-section">
        {sortedPosts.length === 0 ? (
          <p class="no-posts">No articles yet — check back soon!</p>
        ) : (
          <div class="grid">
            {sortedPosts.map((post) => (
              <a class="card" href={`/news/${post.slug ?? post.id}/`}>
                <div class="meta">
                  <time class="date">
                    {post.data.pubDate.toLocaleDateString('en-US', {
                      year: 'numeric',
                      month: 'long',
                      day: 'numeric',
                    })}
                  </time>
                </div>

                <h2>{post.data.title}</h2>

                {post.data.description ? (
                  <p class="desc">{post.data.description}</p>
                ) : (
                  <p class="desc">Read the latest analysis and takeaways.</p>
                )}

                <span class="read">Read →</span>
              </a>
            ))}
          </div>
        )}
      </section>
    </main>

    <Footer />
  </body>
</html>

<style>
  /* Banner */
  .hero-banner { position: relative; width: 100%; overflow: hidden; }
  .hero-banner :global(img) { width: 100%; height: auto; display: block; }
  .nav-overlay { position: absolute; top: 0; left: 0; width: 100%; z-index: 10; }

  .hero-overlay {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: end;
    justify-content: center;
    z-index: 5;
    background: linear-gradient(180deg, rgba(0,0,0,0.0) 20%, rgba(0,0,0,0.65) 85%);
  }

  .hero-inner {
    width: min(1100px, calc(100% - 3rem));
    padding: 0 0 2.25rem;
    text-align: left;
    color: white;
  }

  .hero-inner h1 { margin: 0 0 0.5rem; font-size: clamp(2rem, 3vw, 3rem); letter-spacing: -0.02em; }
  .hero-inner p { margin: 0 0 1.15rem; max-width: 60ch; opacity: 0.92; }

  .hero-actions { display: flex; gap: 0.75rem; flex-wrap: wrap; }

  /* Button */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1rem;
    border-radius: 999px;
    text-decoration: none;
    font-weight: 800;
    border: 1px solid rgba(255,255,255,0.25);
    backdrop-filter: blur(6px);
  }
  .btn.ghost {
    color: white;
    background: rgba(0,0,0,0.25);
  }

  /* Page */
  .page-content { max-width: 1100px; margin: 0 auto; padding: 2.5rem 1.5rem 3rem; }
  .news-section { text-align: left; }

  .no-posts { font-size: 1.1rem; font-style: italic; color: var(--text-secondary); }

  /* Grid Cards */
  .grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 1rem;
    margin-top: 0.25rem;
  }

  .card {
    display: block;
    text-decoration: none;
    color: inherit;
    border: 1px solid var(--gray-light);
    border-radius: 16px;
    padding: 1rem;
    transition: transform 0.12s ease, box-shadow 0.12s ease;
    background: rgba(255,255,255,0.02);
  }

  .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 14px 30px rgba(0,0,0,0.10);
  }

  .meta {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: 0.65rem;
  }

  .date { font-size: 0.85rem; color: var(--text-secondary); }

  .card h2 {
    margin: 0 0 0.6rem;
    font-size: 1.25rem;
    line-height: 1.25;
  }

  .desc {
    margin: 0 0 0.9rem;
    color: var(--text-secondary);
    line-height: 1.55;
  }

  .read { font-weight: 900; }

  @media (max-width: 980px) {
    .grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  }
  @media (max-width: 620px) {
    .grid { grid-template-columns: 1fr; }
    .hero-inner { padding-bottom: 1.5rem; }
  }
</style>
